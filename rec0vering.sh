#! /bin/bash
# Recover fork.

#D=echo # Debug - use 'echo' to aid in debugging

printf "Welcome to rec0vering v1.1, a unc0ver removal script for iOS 11-11.4b3,
This build will removes tweaks, so keep that in
mind. If you have any issues please contact me on Twitter (@Chr1sPwn3d) or on the r/Jailbreak Discord.
Rec0vering removal tool made by Chr1sPwn3d, not associated with unc0ver, including pwn20wnd, sbingner, or any other unc0ver developers.
Ready? (Y/N)"
read runner

if [[ $runner == Y || Yes || y || yes ]]; then # Lets keep chris's code. :-)
:
else
	exit 0
fi

X=(
"/.installed_unc0ver"
"/.cydia_no_stash"
"/.bootstrapped_electra"
"/etc/profile"
"/var/tmp/cydia.log"
"/var/tmp/jailbreakd.pid"
"/var/lib/dpkg"
"/sbin/dmesg"
"/sbin/dynamic_pager"
"/sbin/halt"
"/sbin/quotacheck"
"/sbin/umount"
"/sbin/fstyp"
"/sbin/fstyp_msdos"
"/sbin/fstyp_ntfs"
"/sbin/fstyp_udf"
"/bin/bunzip2"
"/bin/bzcat"
"/bin/bzip2"
"/bin/bzip2recover"
"/bin/cat"
"/bin/chgrp"
"/bin/chmod"
"/bin/chown"
"/bin/cp"
"/bin/date"
"/bin/dd"
"/bin/dir"
"/bin/egrep"
"/bin/false"
"/bin/fgrep"
"/bin/grep"
"/bin/gunzip"
"/bin/gzexe"
"/bin/gzip"
"/bin/kill"
"/bin/ln"
"/bin/launchctl"
"/bin/ls"
"/bin/mkdir"
"/bin/mknod"
"/bin/mktemp"
"/bin/mv"
"/bin/pwd"
"/bin/readlink"
"/run-parts"
"/bin/sed"
"/bin/sh"
"/bin/sleep"
"/bin/stty"
"/bin/sync"
"/bin/tar"
"/bin/touch"
"/bin/true"
"/bin/uname"
"/bin/uncompress"
"/bin/vdir"
"/bin/zcat"
"/bin/zcmp"
"/bin/zdiff"
"/bin/zegrep"
"/bin/zfgrep"
"/bin/zforce"
"/bin/zgrep"
"/bin/zless"
"/bin/zmore"
"/bin/znew"
"/private/etc/profile"
"/private/var/tmp/jailbreakd.pid"
"/private/var/run/utmp"
"/private/var/log/jailbreakd-stderr.log"
"/private/var/log/jailbreakd-stdout.log"
"/usr/bin/["
"/usr/bin/apt-key"
"/usr/bin/arch"
"/usr/bin/asn1Coding"
"/usr/bin/asn1Decoding"
"/usr/bin/asn1Parser"
"/usr/bin/autopoint"
"/usr/bin/b2sum"
"/usr/bin/base32"
"/usr/bin/base64"
"/usr/bin/basename"
"/usr/bin/bashbug"
"/usr/bin/captoinfo"
"/usr/bin/certtool"
"/usr/bin/cfversion"
"/usr/bin/chcon"
"/usr/bin/chfn"
"/usr/bin/chown"
"/usr/bin/chsh"
"/usr/bin/cksum"
"/usr/bin/clear"
"/usr/bin/cmp"
"/usr/bin/comm"
"/usr/bin/csplit"
"/usr/bin/cut"
"/usr/bin/diff"
"/usr/bin/diff3"
"/usr/bin/dircolors"
"/usr/bin/dirmngr"
"/usr/bin/dirmngr-client"
"/usr/bin/dirname"
"/usr/bin/dpkg"
"/usr/bin/dpkg-deb"
"/usr/bin/dpkg-divert"
"/usr/bin/dpkg-maintscript-helper"
"/usr/bin/dpkg-query"
"/usr/bin/dpkg-split"
"/usr/bin/dpkg-statoverride"
"/usr/bin/dpkg-trigger"
"/usr/bin/dselect"
"/usr/bin/du"
"/usr/bin/dumpsexp"
"/usr/bin/ecidecid"
"/usr/bin/env"
"/usr/bin/envsubst"
"/usr/bin/expand"
"/usr/bin/expr"
"/usr/bin/factor"
"/usr/bin/find"
"/usr/bin/fmt"
"/usr/bin/fold"
"/usr/bin/getconf"
"/usr/bin/gettext"
"/usr/bin/gettext.sh"
"/usr/bin/gettextize"
"/usr/bin/getty"
"/usr/bin/gnutls-cli"
"/usr/bin/gnutls-cli-debug"
"/usr/bin/gnutls-serv"
"/usr/bin/gpg"
"/usr/bin/gpg-agent"
"/usr/bin/gpg-connect-agent"
"/usr/bin/gpg-error"
"/usr/bin/gpg-error-config"
"/usr/bin/gpgconf"
"/usr/bin/gpgparsemail"
"/usr/bin/gpgrt-config"
"/usr/bin/gpgscm"
"/usr/bin/gpgsm"
"/usr/bin/gpgtar"
"/usr/bin/gpgv"
"/usr/bin/groups"
"/usr/bin/gssc"
"/usr/bin/head"
"/usr/bin/hmac256"
"/usr/bin/hostid"
"/usr/bin/hostinfo"
"/usr/bin/id"
"/usr/bin/idn2"
"/usr/bin/infocmp"
"/usr/bin/infotocap"
"/usr/bin/install"
"/usr/bin/iomfsetgamma"
"/usr/bin/join"
"/usr/bin/kbxutil"
"/usr/bin/ksba-config"
"/usr/bin/libassuan-config"
"/usr/bin/libgcrypt-config"
"/usr/bin/link"
"/usr/bin/locate"
"/usr/bin/login"
"/usr/bin/logname"
"/usr/bin/lz4"
"/usr/bin/lz4c"
"/usr/bin/lz4cat"
"/usr/bin/lzcat"
"/usr/bin/lzcmp"
"/usr/bin/lzdiff"
"/usr/bin/lzegrep"
"/usr/bin/lzfgrep"
"/usr/bin/lzgrep"
"/usr/bin/lzless"
"/usr/bin/lzma"
"/usr/bin/lzmadec"
"/usr/bin/lzmainfo"
"/usr/bin/lzmore"
"/usr/bin/md5sum"
"/usr/bin/mkfifo"
"/usr/bin/mktemp"
"/usr/bin/mpicalc"
"/usr/bin/msgattrib"
"/usr/bin/msgcat"
"/usr/bin/msgcmp"
"/usr/bin/msgcomm"
"/usr/bin/msgconv"
"/usr/bin/msgen"
"/usr/bin/msgexec"
"/usr/bin/msgfilter"
"/usr/bin/msgfmt"
"/usr/bin/msggrep"
"/usr/bin/msginit"
"/usr/bin/msgmerge"
"/usr/bin/msgunfmt"
"/usr/bin/msguniq"
"/usr/bin/ncurses6-config"
"/usr/bin/ncursesw6-config"
"/usr/bin/nettle-hash"
"/usr/bin/nettle-lfib-stream"
"/usr/bin/nettle-pbkdf2"
"/usr/bin/ngettext"
"/usr/bin/nice"
"/usr/bin/nl"
"/usr/bin/nohup"
"/usr/bin/nproc"
"/usr/bin/npth-config"
"/usr/bin/numfmt"
"/usr/bin/ocsptool"
"/usr/bin/od"
"/usr/bin/p11-kit"
"/usr/bin/p11tool"
"/usr/bin/pagesize"
"/usr/bin/passwd"
"/usr/bin/paste"
"/usr/bin/pathchk"
"/usr/bin/pinky"
"/usr/bin/pkcs1-conv"
"/usr/bin/pr"
"/usr/bin/printenv"
"/usr/bin/psktool"
"/usr/bin/printf"
"/usr/bin/ptx"
"/usr/bin/quota"
"/usr/bin/realpath"
"/usr/bin/recode-sr-latin"
"/usr/bin/renice"
"/usr/bin/reset"
"/usr/bin/runcon"
"/usr/bin/sbdidlaunch"
"/usr/bin/sbreload"
"/usr/bin/script"
"/usr/bin/sdiff"
"/usr/bin/seq"
"/usr/bin/sexp-conv"
"/usr/bin/sha1sum"
"/usr/bin/sha224sum"
"/usr/bin/sha256sum"
"/usr/bin/sha384sum"
"/usr/bin/sha512sum"
"/usr/bin/shred"
"/usr/bin/shuf"
"/usr/bin/sort"
"/usr/bin/split"
"/usr/bin/srptool"
"/usr/bin/stat"
"/usr/bin/stdbuf"
"/usr/bin/sum"
"/usr/bin/sw_vers"
"/usr/bin/tac"
"/usr/bin/tail"
"/usr/bin/tar"
"/usr/bin/tee"
"/usr/bin/test"
"/usr/bin/tic"
"/usr/bin/time"
"/usr/bin/timeout"
"/usr/bin/toe"
"/usr/bin/tput"
"/usr/bin/tr"
"/usr/bin/truncate"
"/usr/bin/trust"
"/usr/bin/tset"
"/usr/bin/tsort"
"/usr/bin/tty"
"/usr/bin/uiduid"
"/usr/bin/uiopen"
"/usr/bin/unexpand"
"/usr/bin/uniq"
"/usr/bin/unlink"
"/usr/bin/unlz4"
"/usr/bin/unlzma"
"/usr/bin/unxz"
"/usr/bin/update-alternatives"
"/usr/bin/updatedb"
"/usr/bin/uptime"
"/usr/bin/users"
"/usr/bin/watchgnupg"
"/usr/bin/wc"
"/usr/bin/which"
"/usr/bin/who"
"/usr/bin/whoami"
"/usr/bin/xargs"
"/usr/bin/xgettext"
"/usr/bin/xz"
"/usr/bin/xzcat"
"/usr/bin/xzcmp"
"/usr/bin/xzdec"
"/usr/bin/xzdiff"
"/usr/bin/xzegrep"
"/usr/bin/xzfgrep"
"/usr/bin/xzgrep"
"/usr/bin/xzless"
"/usr/bin/xzmore"
"/usr/bin/yat2m"
"/usr/bin/yes"
"/usr/libexec/bigram"
"/usr/libexec/code"
"/usr/libexec/jailbreakd"
"/usr/libexec/frcode"
"/usr/libexec/gpg-preset-passphrase"
"/usr/libexec/gpg-protect-tool"
"/usr/libexec/gpg-wks-client"
"/usr/libexec/scdaemon"
"/usr/libexec/vndevice"
"/usr/libexec/coreutils/libstdbuf.so"
"/usr/libexec/gpg-check-pattern"
"/usr/sbin/ac"
"/usr/sbin/accton"
"/usr/sbin/addgnupghome"
"/usr/sbin/applygnupgdefaults"
"/usr/sbin/chown"
"/usr/sbin/chroot"
"/usr/sbin/dev_mkdb"
"/usr/sbin/edquota"
"/usr/sbin/iostat"
"/usr/sbin/mkfile"
"/usr/sbin/nologin"
"/usr/sbin/pwd_mkdb"
"/usr/sbin/quotaon"
"/usr/sbin/repquota"
"/usr/sbin/startupfiletool"
"/usr/sbin/sysctl"
"/usr/sbin/vifs"
"/usr/sbin/vipw"
"/usr/sbin/vsdbutil"
"/usr/sbin/zdump"
"/usr/sbin/zic"
"/usr/local/bin/debugserver"
"/usr/include/assuan.h"
"/usr/include/autosprintf.h"
"/usr/include/eti.h"
"/usr/include/gettext-po.h"
"/usr/include/gmp.h"
"/usr/include/gpgrt.h"
"/usr/include/idn2.h"
"/usr/include/libtasn1.h"
"/usr/include/lz4.h"
"/usr/include/lzma.h"
"/usr/include/nc_tparm.h"
"/usr/include/ncurses_dll.h"
"/usr/include/npth.h"
"/usr/include/term_entry.h"
"/usr/include/tic.h"
"/usr/include/unctrl.h"
"/usr/include/unigbrk.h"
"/usr/include/uninorm.h"
"/usr/include/unistdio.h"
"/usr/include/unitypes.h"
"/usr/include/uniwbrk.h"
"/usr/include/form.h"
"/usr/include/gcrypt.h"
"/usr/include/gpg-error.h"
"/usr/include/ksba.h"
"/usr/include/libintl.h"
"/usr/include/lz4frame.h"
"/usr/include/lz4hc.h"
"/usr/include/lzmadec.h"
"/usr/include/menu.h"
"/usr/include/ncurses.h"
"/usr/include/panel.h"
"/usr/include/term.h"
"/usr/include/termcap.h"
"/usr/include/unicase.h"
"/usr/include/uniconv.h"
"/usr/include/unilbrk.h"
"/usr/include/uniname.h"
"/usr/include/unistr.h"
"/usr/include/uniwidth.h"
"/usr/include/curses.h"
"/usr/lib/tweakloader.dylib"
"/usr/lib/libapt-inst.2.0.0.dylib"
"/usr/lib/libapt-inst.2.0.dylib"
"/usr/lib/libapt-inst.dylib"
"/usr/lib/libapt-pkg.5.0.1.dylib"
"/usr/lib/libapt-pkg.5.0.dylib"
"/usr/lib/libapt-pkg.dylib"
"/usr/lib/libapt-private.0.0.0.dylib"
"/usr/lib/libapt-private.0.0.dylib"
"/usr/lib/libasprintf.0.dylib"
"/usr/lib/libasprintf.dylib"
"/usr/lib/libassuan.0.dylib"
"/usr/lib/libassuan.dylib"
"/usr/lib/libassuan.la"
"/usr/lib/libdpkg.a"
"/usr/lib/libform.5.dylib"
"/usr/lib/libform.6.dylib"
"/usr/lib/libform5.dylib"
"/usr/lib/libformw.5.dylib"
"/usr/lib/libformw.6.dylib"
"/usr/lib/libformw.dylib"
"/usr/lib/libformw5.dylib"
"/usr/lib/libgcrypt.20.dylib"
"/usr/lib/libgcrypt.dylib"
"/usr/lib/libgcrypt.la"
"/usr/lib/libgettextlib-0.19.8.dylib"
"/usr/lib/libgettextlib.dylib"
"/usr/lib/libgettextpo.1.dylib"
"/usr/lib/libgettextpo.dylib"
"/usr/lib/libgettextsrc-0.19.8.dylib"
"/usr/lib/libgettextsrc.dylib"
"/usr/lib/libgmp.10.dylib"
"/usr/lib/libgmp.dylib"
"/usr/lib/libgmp.la"
"/usr/lib/libgnutls.30.dylib"
"/usr/lib/libgnutls.dylib"
"/usr/lib/libgnutlsxx.28.dylib"
"/usr/lib/libgnutlsxx.dylib"
"/usr/lib/libgpg-error.0.dylib"
"/usr/lib/libgpg-error.dylib"
"/usr/lib/libgpg-error.la"
"/usr/lib/libhistory.5.2.dylib"
"/usr/lib/libhistory.5.dylib"
"/usr/lib/libhistory.7.0.dylib"
"/usr/lib/libhistory.7.dylib"
"/usr/lib/libhistory.dylib"
"/usr/lib/libhogweed.4.4.dylib"
"/usr/lib/libhogweed.4.dylib"
"/usr/lib/libhogweed.dylib"
"/usr/lib/libidn2.0.dylib"
"/usr/lib/libidn2.dylib"
"/usr/lib/libidn2.la"
"/usr/lib/libintl.9.dylib"
"/usr/lib/libintl.dylib"
"/usr/lib/libjailbreak.dylib"
"/usr/lib/libksba.8.dylib"
"/usr/lib/libksba.dylib"
"/usr/lib/libksba.la"
"/usr/lib/liblz4.1.7.5.dylib"
"/usr/lib/liblz4.1.dylib"
"/usr/lib/liblz4.dylib"
"/usr/lib/liblzmadec.0.dylib"
"/usr/lib/liblzmadec.dylib"
"/usr/lib/libmenu.5.dylib"
"/usr/lib/libmenu.6.dylib"
"/usr/lib/libmenu.dylib"
"/usr/lib/libmenu5.dylib"
"/usr/lib/libmenuw.5.dylib"
"/usr/lib/libmenuw.6.dylib"
"/usr/lib/libmenuw.dylib"
"/usr/lib/libmenuw5.dylib"
"/usr/lib/libncurses.6.dylib"
"/usr/lib/libncurses5.dylib"
"/usr/lib/libncurses6.dylib"
"/usr/lib/libncursesw.5.dylib"
"/usr/lib/libncursesw.6.dylib"
"/usr/lib/libncursesw.dylib"
"/usr/lib/libncursesw5.dylib"
"/usr/lib/libncursesw6.dylib"
"/usr/lib/libnettle.6.4.dylib"
"/usr/lib/libnettle.6.dylib"
"/usr/lib/libnettle.dylib"
"/usr/lib/libnpth.0.dylib"
"/usr/lib/libnpth.dylib"
"/usr/lib/libnpth.la"
"/usr/lib/libp11-kit.0.dylib"
"/usr/lib/libp11-kit.dylib"
"/usr/lib/libp11-kit.la"
"/usr/lib/libpanel.5.dylib"
"/usr/lib/libpanel.6.dylib"
"/usr/lib/libpanel.dylib"
"/usr/lib/libpanel5.dylib"
"/usr/lib/libpanelw.5.dylib"
"/usr/lib/libpanelw.6.dylib"
"/usr/lib/libpanelw.dylib"
"/usr/lib/libpanelw5.dylib"
"/usr/lib/libreadline.5.2.dylib"
"/usr/lib/libreadline.5.dylib"
"/usr/lib/libreadline.7.0.dylib"
"/usr/lib/libreadline.7.dylib"
"/usr/lib/libreadline.dylib"
"/usr/lib/libssl.1.0.0.dylib"
"/usr/lib/libssl.dylib"
"/usr/lib/libstdc++.6.0.9.dylib"
"/usr/lib/libsubstitute.0.dylib"
"/usr/lib/libtasn1.6.dylib"
"/usr/lib/libtasn1.dylib"
"/usr/lib/libtasn1.la"
"/usr/lib/libunistring.2.dylib"
"/usr/lib/libunistring.dylib"
"/usr/lib/libunistring.la"
"/usr/lib/p11-kit-proxy.dylib"
"/usr/lib/pspawn_hook.dylib"
"/electra"
"/jb"
"/Library/MobileSubstrate"
"/Library/PreferenceBundles"
"/Library/PreferenceLoader"
"/Library/dpkg"
"/Library/Themes"
"/Library/LaunchDaemons"
"/etc/alternatives"
"/etc/apt"
"/etc/default"
"/etc/dpkg"
"/etc/profile.d"
"/etc/rc.d"
"/var/cache/apt"
"/var/mobile/Library/Cydia"
"/var/mobile/Library/Caches/com.saurik.Cydia"
"/var/mobile/Library/Logs/Cydia"
"/var/mobile/Library/Preferences"
"/var/lib/apt"
"/var/lib/cydia"
"/var/lib/misc"
"/private/etc/alternatives"
"/private/etc/apt"
"/private/etc/dpkg"
"/private/etc/profile.d"
"/private/rc.d"
"/private/var/mobile/Library/Cydia"
"/private/var/log/apt"
"/private/var/lib/apt"
"/private/var/lib/cydia"
"/private/var/lib/dpkg"
"/private/var/lib/misc"
"/private/var/cache/apt"
"/usr/libexec/apt"
"/usr/libexec/cydia"
"/usr/libexec/dpkg"
"/usr/libexec/p11-kit"
"/usr/libexec/coreutils"
"/usr/local/lib"
"/usr/include/dpkg"
"/usr/include/lzma"
"/usr/include/nettle"
"/usr/include/readline"
"/usr/include/gnutls"
"/usr/include/ncursesw"
"/usr/include/p11-kit-1"
"/usr/include/unistring"
"/usr/share/aclocal"
"/usr/share/bigboss"
"/usr/share/common-lisp"
"/usr/share/dict"
"/usr/share/dpkg"
"/usr/share/gnupg"
"/usr/share/libgpg-error"
"/usr/share/p11-kit"
"/usr/share/tabset"
"/usr/share/terminfo"
"/usr/lib/_ncurses"
"/usr/lib/apt"
"/usr/lib/bash"
"/usr/lib/p7zip"
"/usr/lib/tweaks"
"/usr/lib/gettext"
"/usr/lib/ssl"
"/usr/lib/pkcs11"
"/usr/lib/pkgconfig"
"/usr/lib/terminfo"
"/usr/etc"
"/System/Library/Internet_Plug-ins"
"/System/Library/KeyboardDictionaries"
"/Applications/Cydia.app"
)

P=(
"com.ex.substitute"
"science.xnu.undecimus.resources"
"science.xnu.injector"
"com.sbingner.spawn"
)

e(){ # https://stackoverflow.com/questions/1885525/how-do-i-prompt-a-user-for-confirmation-in-bash-script
	printf "Something has gone wrong!\n\tDo you want to continue?\n"
	read -t 30 -p "[y/N]" -n 1 -r
	if [[ $REPLY =~ ^[Yy]$ ]]; then # =~ means regex
		:
	else
		exit 1
	fi
}

r(){
	if [[ -d $1 ]]; then
		printf "($2)\tRemoving directory $1\n"
		$D rm -rf $1	|| e
	elif [[ -e $1 ]]; then
		printf "($2)\tRemoving file $1\n"
		$D rm -f $1	|| e
	else
		[[ ! -d $1 && ! -e $1 ]] && \
		printf "($2)\tSkipping $1\n" 1>&2
	fi
}

for i in ${P[@]}; do
        let c=c+1
	printf "(dpkg: $c) Removing $i\n"
        $D /usr/bin/dpkg --force-all -P "$i" || e
done

let c=0
for i in ${X[@]}; do
	let c=c+1
	r $i $c
done

printf "Done\n"

exit 0
